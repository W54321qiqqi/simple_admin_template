import{_ as E}from"./index-3e68dd2f.js";import{d as O}from"./index-0ffd3390.js";import{a as D,i as F,l as R,m as I,c as M,b9 as T,o as p,e as y,r as V,f as a,F as $,v as C,n as X,h as Y,g as w,a3 as m,z as N,t as B,q}from"./index-ae101c87.js";import"./el-popper-adc308a2.js";const G=["onMousedown"],J={key:1,class:"vue-drag-info"},K={key:0},Q={key:1},U=D({__name:"index",props:{w:{type:Number,default:200},h:{type:Number,default:200},x:{type:Number,default:0},y:{type:Number,default:0},zIndex:{type:[Number,String],default:10},sticks:{type:Array,default:()=>["tl","tm","tr","ml","mr","bl","bm","br"]},stickSize:{type:Number,default:8},isResizable:{type:Boolean,default:!0},isDraggable:{type:Boolean,default:!0},isActive:{type:Boolean,default:!1},minWidth:{type:Number,default:50},minHeight:{type:Number,default:50}},emits:["resized","update:w","update:h","update:x","update:y","resizing","draged","draging"],setup(x,{emit:r}){const u=x,k={x:{l:"left",m:"marginLeft",r:"right"},y:{t:"top",m:"marginTop",b:"bottom"}},e=F({draging:!1,resizing:!1,active:!1,boxStyle:{top:"",left:"",width:"",height:""},currentStick:null,beforeMove:{left:null,top:null,width:null,height:null,oldPageX:null,oldPageY:null}}),z=R();I(()=>{O(document,"mousedown",H)});const b=M(()=>{const{zIndex:n}=u,{top:o,left:t,width:l,height:i}=e.boxStyle;return{left:t+"px",top:o+"px",width:l+"px",height:i+"px",zIndex:n}}),_=M(()=>{const{stickSize:n}=u;return o=>{const t={width:n+"px",height:n+"px"};return t[k.y[o[0]]]=-n/2+"px",t[k.x[o[1]]]=-n/2+"px",t}}),H=()=>{e.active=!1};function L(n,o){o.stopPropagation(),e.currentStick=n;const{pageX:t,pageY:l}=o;e.resizing=!0,P({oldPageX:t,oldPageY:l}),document.onmousemove=i=>W(i),document.onmouseup=async()=>{document.onmousemove=null,document.onmouseup=null,e.currentStick=null,r("resized",e.boxStyle),e.beforeMove={left:null,top:null,width:null,height:null,oldPageX:null,oldPageY:null},e.resizing=!1}}function P(n){const{left:o,top:t,height:l,width:i}=e.boxStyle;e.beforeMove={left:o,top:t,height:l,width:i,...n}}function W(n){const{pageX:o,pageY:t}=n,{top:l,left:i,height:d,width:c,oldPageX:s,oldPageY:g}=e.beforeMove;let f=d,h=c,S=l,v=i;switch(e.currentStick){case"tl":S=t-g+l,v=o-s+i,f=g-t+d,h=s-o+c;break;case"tm":f=g-t+d,S=t-g+l;break;case"tr":S=t-g+l,f=g-t+d,h=o-s+c;break;case"ml":v=o-s+i,h=s-o+c;break;case"mr":h=o-s+c;break;case"bl":v=o-s+i,h=s-o+c,f=t-g+d;break;case"bm":f=t-g+d;break;case"br":f=t-g+d,h=o-s+c;break}h>=u.minWidth&&(e.boxStyle.left=v,e.boxStyle.width=h,r("update:w",e.boxStyle.width),r("update:x",e.boxStyle.left)),f>=u.minHeight&&(e.boxStyle.top=S,e.boxStyle.height=f,r("update:h",e.boxStyle.height),r("update:y",e.boxStyle.top)),r("resizing",{width:e.boxStyle.width,height:e.boxStyle.height,left:e.boxStyle.left,top:e.boxStyle.top})}function j(n){if(e.active=!0,n.stopPropagation(),!u.isDraggable)return;const{pageX:o,pageY:t}=n;P({oldPageX:o,oldPageY:t}),e.draging=!0,document.onmousemove=l=>A(l),document.onmouseup=async()=>{document.onmousemove=null,document.onmouseup=null,r("draged",{left:e.boxStyle.left,top:e.boxStyle.top}),e.beforeMove={left:null,top:null,width:null,height:null,oldPageX:null,oldPageY:null},e.draging=!1}}async function A(n){const{pageX:o,pageY:t}=n,{top:l,left:i,oldPageX:d,oldPageY:c}=e.beforeMove,s={left:o-d+i,top:t-c+l};Object.assign(e.boxStyle,s),r("update:x",s.left),r("update:y",s.top),r("draging",s)}return T(()=>{e.active=u.isActive,e.boxStyle.left=u.x,e.boxStyle.top=u.y,e.boxStyle.height=u.h,e.boxStyle.width=u.w}),(n,o)=>(p(),y("div",{class:X(["base-drag-reisze",{active:a(e).active,"vue-drag-moving":a(e).draging,"vue-drag-resizing":a(e).resizing}]),ref_key:"baseDragRef",ref:z,style:Y(a(b)),onMousedown:o[0]||(o[0]=t=>j(t))},[V(n.$slots,"default"),a(e).active&&x.isResizable?(p(!0),y($,{key:0},C(x.sticks,t=>(p(),y("div",{key:t,class:X(["vue-drag-stick",`vue-drag-stick-${t}`]),style:Y(a(_)(t)),onMousedown:l=>L(t,l)},null,46,G))),128)):w("",!0),a(e).draging||a(e).resizing?(p(),y("div",J,[a(e).draging?(p(),y("span",K," X："+m(a(e).boxStyle.left)+"，Y："+m(a(e).boxStyle.top),1)):w("",!0),a(e).resizing?(p(),y("span",Q," H："+m(a(e).boxStyle.height)+"，W："+m(a(e).boxStyle.width),1)):w("",!0)])):w("",!0)],38))}});const Z={class:"index"},le=D({__name:"index",setup(x){const r=R([{w:150,h:150,x:0,y:0},{w:150,h:150,x:200,y:100}]);return(u,k)=>{const e=U,z=E;return p(),N(z,{height:"600px",class:"grid"},{default:B(()=>[(p(!0),y($,null,C(a(r),(b,_)=>(p(),N(e,{key:_,w:b.w,h:b.h,x:b.x,y:b.y,class:"resize-item flex-center"},{default:B(()=>[q("span",Z,m(_+1),1)]),_:2},1032,["w","h","x","y"]))),128))]),_:1})}}});export{le as default};
